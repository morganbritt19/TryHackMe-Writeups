# [Corridor THM Room](https://tryhackme.com/r/room/corridor)
## Scanning
### Nmap
```
nmap -sC -sV -oN nmapInitial target-ip
```

```python
Starting Nmap 7.60 ( https://nmap.org ) at 2024-03-20 13:51 GMT
Nmap scan report for ip-10-10-212-243.eu-west-1.compute.internal (10.10.212.243)
Host is up (0.00081s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Werkzeug httpd 2.0.3 (Python 3.10.2)
|_http-server-header: Werkzeug/2.0.3 Python/3.10.2
|_http-title: Corridor
MAC Address: 02:D5:24:A6:5C:99 (Unknown)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.18 seconds
```

### Gobuster
```
gobuster dir -u http://target-ip -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

```go
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.212.243
[+] Threads:        10
[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2024/03/20 13:58:32 Starting gobuster
===============================================================
Progress: 220561 / 220561 (83.34%)
===============================================================
2024/03/20 14:30:33 Finished
===============================================================
```

## Enumeration
Based on our Nmap scan, it looks like the target machine is hosting a simple web application titled Corridor. When we navigate over to the web page, we are greeted with the following:

![Initial Web Page](https://github.com/morganbritt19/TryHackMe-Writeups/assets/60797871/f00b7a93-1287-44cc-8886-e3764967e90a)



Unfortunately, out initial Gobuster scan didn't yield any worthwhile results. However, by exploring the webpage, we can see that each door has a link to a different URL. For example, the first door on the left has a URL of `target-ip/c4ca4238a0b923820dcc509a6f75849b`. Here is what the page shows:

![Room 1 on Left](https://github.com/morganbritt19/TryHackMe-Writeups/assets/60797871/3222eb53-daf8-4148-891d-61770e287313)



This doesn't give us a lot to go on. It seems like every door we click on redirects to a page with a different subdirectory with a 32 character string. To me, that string doesn't look like something that is Base64 encoded, but rather something generated by a hash function. We can try and crack this hash with an offline tool like John The Ripper, but let's start with something easy like [Crackstation](https://crackstation.net/). I took the `c4ca4238a0b923820dcc509a6f75849b` value and plugged it into [Crackstation](https://crackstation.net/) and got the following:

![Crackstation for MD5 Hash of 1](https://github.com/morganbritt19/TryHackMe-Writeups/assets/60797871/336b8a20-27f2-46bb-92ec-df178c85a2e0)



So we have an MD5 hash value for the number 1. Let's try to plug in some of the other values and see what we come up with. Here are the ones I looked at, starting from left and going clockwise around the corridor:

![All Door Hashes](https://github.com/morganbritt19/TryHackMe-Writeups/assets/60797871/7813edae-1c7b-4238-80f3-30189c07e691)



There seems to be a theme here. It stands to reason that we can hash values of other numbers and try to use that as a subdirectory to navigate to. For example, we can hash the value 14 with the MD5 function in [CyberChef](https://cyberchef.org). Here is what we get: `367764329430db34be92fd14a7a770ee`. Let's enter that as a subdirectory in our web browser and see what we can see:

![Not Found](https://github.com/morganbritt19/TryHackMe-Writeups/assets/60797871/3efe96f5-a725-4432-a50c-06c73650a2d8)



We get the same result when we try other numbers going up to fifteen and beyond. With that in mind, let's try to go down and see what we get. Since we started at 1, let's hash the value of 0 and navigate to that subdirectory. 

![Flag](https://github.com/morganbritt19/TryHackMe-Writeups/assets/60797871/c685cf78-31ce-48eb-945e-61196667e431)



It looks like that worked! This seems to be a pretty simple implementation of a web application that is vulnerable to an IDOR vulnerability and demonstrates how it can be exploited to gain access to things not intended for end users. 
